<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPA Calculator</title>
    <link rel="stylesheet" th:href="@{/css/gpa.css}">
	
	<script>
	    function goToSemester(button) {
	        const semesterId = button.dataset.semester;

	        // ✅ span 태그에서 값 읽어오기
	        const userId = document.getElementById("sessionUserId").innerText.trim();

	        const url = `/gpa/view?userId=${userId}&semesterId=${semesterId}`;
	        window.location.href = url;
	    }
	</script>
	
</head>
<body>
	<!-- 안전하게 Thymeleaf 값 삽입 -->
	<span id="sessionUserId" th:text="${session.userId}" hidden></span>

<div class="container">
    <!-- 왼쪽 사용자 정보 탭 -->
    <div class="sidebar">
        <h2>사용자 정보</h2>
        <p><strong>이름:</strong> <span>이유진</span></p>
		<p><strong>학번:</strong> <span th:text="${session.userId ?: '정보 없음'}">202345011</span></p>
        <p><strong>학과:</strong> <span>컴퓨터시스템공학</span></p>
    </div>

    <!-- 메인 콘텐츠 -->
    <div class="main-content">
        <h1 style="margin: 0px 10px 20px 10px;">학점 정보</h1>
		<hr style="margin: 0px 0px 10px 0px">
		
		<input type="hidden" id="userId" th:value="${gpa.userId}">

		<!-- 학기별 학점 정보 표시 -->
		<div class="semester-tabs">
			<button class="semester-tab" 
				data-semester="1-1" 
			    th:classappend="${semesterId == '1-1'} ? 'active' : ''"
			    onclick="goToSemester(this)">1학년 1학기</button>
			<button class="semester-tab" 
				data-semester="1-2" 
				th:classappend="${semesterId == '1-2'} ? 'active' : ''"
				onclick="goToSemester(this)">1학년 2학기</button>
			<button class="semester-tab" 
	            data-semester="2-1" 
	            th:classappend="${semesterId == '2-1'} ? 'active' : ''"
	            onclick="goToSemester(this)">2학년 1학기</button>
			<button class="semester-tab" 
	            data-semester="2-2" 
	            th:classappend="${semesterId == '2-2'} ? 'active' : ''"
	            onclick="goToSemester(this)">2학년 2학기</button>
			<button class="semester-tab" 
            	data-semester="3-1" 
				th:classappend="${semesterId == '3-1'} ? 'active' : ''"
				onclick="goToSemester(this)">3학년 1학기</button>
			<button class="semester-tab" 
				data-semester="3-2" 
				th:classappend="${semesterId == '3-2'} ? 'active' : ''"
				onclick="goToSemester(this)">3학년 2학기</button>
			<button class="semester-tab"
				data-semester="4-1"
				th:classappend="${semesterId == '4-1'} ? 'active' : ''"
				onclick="goToSemester(this)">4학년 1학기</button>
			<button class="semester-tab"
				data-semester="4-2"
				th:classappend="${semesterId == '4-2'} ? 'active' : ''"
				onclick="goToSemester(this)">4학년 2학기</button>
		</div>

        <div class="gpa-info">
            <div class="gpa-item">
                <label for="totalCredits">전체 학점:</label>
                <span th:text="${gpa.totalCredits}">80</span>
            </div>
            <div class="gpa-item">
                <label for="majorCredits">전공 학점:</label>
                <span th:text="${gpa.majorCredits}">65</span>
            </div>
            <div class="gpa-item">
                <label for="electiveCredits">교양 학점:</label>
                <span th:text="${gpa.electiveCredits}">15</span>
            </div>
            <div class="gpa-item">
                <label for="totalGPA">전체 평점:</label>
                <span th:text="${gpa.totalGpa}">3.5</span>
            </div>
            <div class="gpa-item">
                <label for="majorGPA">전공 평점:</label>
                <span th:text="${gpa.majorGpa}">3.5</span>
            </div>
            <div class="gpa-item">
                <label for="electiveGPA">교양 평점:</label>
                <span th:text="${gpa.electiveGpa}">3.5</span>
            </div>
        </div>

        <!-- 학점 통계 (그래프나 표) -->
        <div class="gpa-statistics">
            <h2>학점 통계</h2>
            <!-- 그래프나 표를 나중에 삽입할 영역 -->
        </div>

        <!-- 학점 입력 폼 -->
        <div class="input-form">
            <h2>학점 입력</h2>
            <form action="/gpa/calculate" method="POST">
                <table>
                    <tr>
                        <td><label for="courseName">과목명:</label></td>
                        <td><input type="text" id="courseName" name="courseName" required></td>
                    </tr>
                    <tr>
                        <td><label for="credit">학점:</label></td>
                        <td><input type="number" id="credit" name="credit" required></td>
                    </tr>
                    <tr>
                        <td><label for="grade">성적:</label></td>
                        <td><input type="number" step="0.01" id="grade" name="grade" required></td>
                    </tr>
                    <tr>
                        <td><label for="major">전공 여부:</label></td>
                        <td><input type="checkbox" id="major" name="major"></td>
                    </tr>
                </table>
                <input type="submit" value="학점 추가">
            </form>
        </div>
    </div>
</div>

</body>
</html>
