<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>포트폴리오 목록</title>
    <link rel="stylesheet" th:href="@{/css/portfolio.css}">
</head>
<body>
    <div class="container">
        <h1>포트폴리오 목록</h1>

        <form action="/portfolios" method="get" class="form">
            <select name="sortBy">
                <option value="date" th:selected="${sortBy == 'date'}">날짜순</option>
                <option value="name" th:selected="${sortBy == 'name'}">이름순</option>
            </select>
            <input type="text" name="searchKeyword" th:value="${searchKeyword}" placeholder="검색어 입력" style="width: 30%; flex-wrap: wrap;" />
            <button type="submit" class="btn">검색</button>
        </form>

        <div class="actions">
            <a th:href="@{/portfolios/upload(userId=${userId})}" class="btn primary">새 포트폴리오 업로드</a>
        </div>

        <div class="portfolio-list">
            <table th:if="${!portfolios.empty}">
                <thead>
                    <tr>
                        <th>제목</th>
                        <th>파일</th>
                        <th>기간</th>
                        <th>생성일</th>
                        <th>액션</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="portfolio : ${portfolios}">
                        <td th:text="${portfolio.title}"></td>
                        <td>
                            <a th:href="@{'/api/files/download/' + ${portfolio.fileName}}"
                               th:download="${portfolio.fileName}">
                                <span th:text="${portfolio.fileName}"></span>
                            </a>
                            <span class="badge" th:text="${portfolio.fileExtension}"></span>
                        </td>
                        <td>
                            <span th:text="${#temporals.format(portfolio.startDate, 'yyyy-MM-dd')}"></span> ~ 
                            <span th:text="${#temporals.format(portfolio.endDate, 'yyyy-MM-dd')}"></span>
                        </td>
                        <td th:text="${#temporals.format(portfolio.createdAt, 'yyyy-MM-dd HH:mm')}"></td>
                        <td>
                            <a th:href="@{/portfolios/{id}(id=${portfolio.id})}" class="btn small">보기</a>
                            <a th:href="@{/portfolios/{id}/delete(id=${portfolio.id}, userId=${userId})}" 
                               class="btn small danger"
                               onclick="return confirm('정말 삭제하시겠습니까?');">삭제</a>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div th:if="${portfolios.empty}">
                <p>업로드된 포트폴리오가 없습니다.</p>
            </div>
        </div>
    </div>
</body>
</html>
